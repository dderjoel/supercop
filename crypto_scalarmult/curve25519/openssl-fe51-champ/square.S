.text
.global CRYPTO_NAMESPACE(fiat_curve25519_carry_square)
CRYPTO_NAMESPACE(fiat_curve25519_carry_square):
	imul   $0x26,0x18(%rsi),%rax
	mov    0x18(%rsi),%r10
	lea    (%r10,%r10,8),%r11
	lea    (%r10,%r11,2),%rdx
	imul   $0x26,0x20(%rsi),%r10
	mov    %rdx,%r11
	mov    0x8(%rsi),%rdx
	mulx   %rdx,%rcx,%r8
	mov    %rax,%rdx
	mulx   0x10(%rsi),%rax,%r9
	mov    %r10,%rdx
	mov    %rbx,-0x80(%rsp)
	mulx   0x18(%rsi),%r10,%rbx
	mov    %r12,-0x78(%rsp)
	xor    %r12,%r12
	adox   %rcx,%r10
	adox   %rbx,%r8
	mulx   0x8(%rsi),%rcx,%rbx
	adcx   %rcx,%rax
	adcx   %r9,%rbx
	mov    %rdx,%r9
	mov    (%rsi),%rdx
	mulx   %rdx,%rcx,%r12
	xor    %rdx,%rdx
	adox   %rcx,%rax
	adox   %rbx,%r12
	mov    0x10(%rsi),%rdx
	mulx   %r9,%rbx,%rcx
	mov    %r11,%rdx
	mulx   0x18(%rsi),%r11,%r9
	adcx   %rbx,%r11
	adcx   %r9,%rcx
	mov    0x8(%rsi),%rdx
	lea    (%rdx,%rdx,1),%rbx
	mov    (%rsi),%rdx
	mov    %r13,-0x70(%rsp)
	mulx   %rbx,%r9,%r13
	add    %r9,%r11
	adcx   %rcx,%r13
	mov    %rax,%rdx
	shrd   $0x33,%r12,%rdx
	xor    %r12,%r12
	adox   %rdx,%r11
	adox   %r12,%r13
	mov    0x10(%rsi),%rcx
	lea    (%rcx,%rcx,1),%rbx
	mov    (%rsi),%rdx
	mulx   %rbx,%rcx,%r9
	adcx   %rcx,%r10
	adcx   %r8,%r9
	mov    0x8(%rsi),%rdx
	mulx   %rbx,%r8,%rcx
	imul   $0x13,0x20(%rsi),%rdx
	mov    %r11,%rbx
	shrd   $0x33,%r13,%rbx
	xor    %r13,%r13
	adox   %rbx,%r10
	adox   %r13,%r9
	mov    %r10,%r12
	shrd   $0x33,%r9,%r12
	mulx   0x20(%rsi),%rbx,%r9
	add    %r8,%rbx
	adcx   %r9,%rcx
	mov    0x18(%rsi),%r8
	lea    (%r8,%r8,1),%rdx
	mulx   (%rsi),%r8,%r9
	add    %r8,%rbx
	adcx   %rcx,%r9
	add    %r12,%rbx
	adc    $0x0,%r9
	mov    %rbx,%r12
	shrd   $0x33,%r9,%r12
	mulx   0x8(%rsi),%rcx,%r8
	mov    0x10(%rsi),%rdx
	mulx   %rdx,%r9,%r13
	xor    %rdx,%rdx
	adox   %rcx,%r9
	adox   %r13,%r8
	mov    0x20(%rsi),%rcx
	mov    %rcx,%r13
	shl    %r13
	mov    %r13,%rdx
	mulx   (%rsi),%rcx,%r13
	movabs $0x7ffffffffffff,%rdx
	and    %rdx,%rax
	adox   %rcx,%r9
	adox   %r8,%r13
	adcx   %r12,%r9
	adc    $0x0,%r13
	mov    %r9,%r12
	shrd   $0x33,%r13,%r12
	imul   $0x13,%r12,%r8
	and    %rdx,%r9
	mov    %r9,0x20(%rdi)
	and    %rdx,%r11
	lea    (%rax,%r8,1),%rax
	mov    %rax,%rcx
	and    %rdx,%rcx
	shr    $0x33,%rax
	lea    (%rax,%r11,1),%rax
	mov    %rcx,(%rdi)
	mov    %rax,%r13
	and    %rdx,%r13
	and    %rdx,%r10
	and    %rdx,%rbx
	shr    $0x33,%rax
	lea    (%rax,%r10,1),%rax
	mov    %rax,0x10(%rdi)
	mov    %rbx,0x18(%rdi)
	mov    %r13,0x8(%rdi)
	mov    -0x80(%rsp),%rbx
	mov    -0x78(%rsp),%r12
	mov    -0x70(%rsp),%r13
	ret
