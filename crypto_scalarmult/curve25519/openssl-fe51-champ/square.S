.text
.global CRYPTO_NAMESPACE(fiat_curve25519_carry_square)
CRYPTO_NAMESPACE(fiat_curve25519_carry_square):
	imul   $0x26,0x18(%rsi),%rax
	mov    0x10(%rsi),%r10
	mov    %r10,%r11
	shl    %r11
	imul   $0x26,0x20(%rsi),%r10
	mov    %rax,%rdx
	mulx   0x10(%rsi),%rax,%rcx
	mov    0x8(%rsi),%rdx
	mulx   %r10,%r8,%r9
	imul   $0x13,0x18(%rsi),%rdx
	mov    %rbx,-0x80(%rsp)
	mov    0x8(%rsi),%rbx
	mov    %rbp,-0x78(%rsp)
	mov    %rbx,%rbp
	shl    %rbp
	mov    %r12,-0x70(%rsp)
	mulx   0x18(%rsi),%rbx,%r12
	mov    0x10(%rsi),%rdx
	mov    %r13,-0x68(%rsp)
	mov    %r14,-0x60(%rsp)
	mulx   %r10,%r13,%r14
	xor    %rdx,%rdx
	adox   %r13,%rbx
	adox   %r12,%r14
	mov    (%rsi),%rdx
	mulx   %rdx,%r12,%r13
	adcx   %r8,%rax
	adcx   %rcx,%r9
	xor    %rdx,%rdx
	adox   %r12,%rax
	adox   %r9,%r13
	mov    (%rsi),%rdx
	mulx   %rbp,%rcx,%r8
	adcx   %rcx,%rbx
	adcx   %r14,%r8
	mov    %rax,%rdx
	shrd   $0x33,%r13,%rdx
	add    %rdx,%rbx
	adc    $0x0,%r8
	mov    %rbx,%rbp
	shrd   $0x33,%r8,%rbp
	mov    0x8(%rsi),%rdx
	mulx   %rdx,%r14,%r12
	mov    %r10,%rdx
	mulx   0x18(%rsi),%r10,%r9
	xor    %rdx,%rdx
	adox   %r14,%r10
	adox   %r9,%r12
	mov    %r11,%rdx
	mulx   (%rsi),%r11,%r13
	adcx   %r11,%r10
	adcx   %r12,%r13
	mov    0x18(%rsi),%rcx
	lea    (%rcx,%rcx,1),%r8
	xor    %rcx,%rcx
	adox   %rbp,%r10
	adox   %rcx,%r13
	imul   $0x13,0x20(%rsi),%rbp
	mov    $0x1,%r14d
	shlx   %r14,0x20(%rsi),%r9
	mov    %r10,%r12
	shrd   $0x33,%r13,%r12
	mulx   0x8(%rsi),%r11,%r13
	mov    0x20(%rsi),%rdx
	mulx   %rbp,%rcx,%r14
	xor    %rdx,%rdx
	adox   %r11,%rcx
	adox   %r14,%r13
	mov    %r8,%rdx
	mulx   (%rsi),%r8,%rbp
	adcx   %r8,%rcx
	adcx   %r13,%rbp
	mulx   0x8(%rsi),%r11,%r14
	mov    0x10(%rsi),%rdx
	mulx   %rdx,%r13,%r8
	xor    %rdx,%rdx
	adox   %r12,%rcx
	adox   %rdx,%rbp
	adcx   %r11,%r13
	adcx   %r8,%r14
	mov    %rcx,%r12
	shrd   $0x33,%rbp,%r12
	movabs $0x7ffffffffffff,%r11
	and    %r11,%rcx
	mov    (%rsi),%rdx
	mulx   %r9,%r8,%rbp
	adox   %r8,%r13
	adox   %r14,%rbp
	adcx   %r12,%r13
	adc    $0x0,%rbp
	mov    %r13,%rdx
	and    %r11,%rdx
	shrd   $0x33,%rbp,%r13
	mov    %rdx,0x20(%rdi)
	and    %r11,%rax
	and    %r11,%rbx
	imul   $0x13,%r13,%r9
	lea    (%rax,%r9,1),%rax
	mov    %rax,%r14
	shr    $0x33,%r14
	and    %r11,%r10
	lea    (%r14,%rbx,1),%r14
	mov    %r14,%r12
	shr    $0x33,%r12
	lea    (%r12,%r10,1),%r12
	and    %r11,%r14
	mov    %r14,0x8(%rdi)
	mov    %r12,0x10(%rdi)
	and    %r11,%rax
	mov    %rax,(%rdi)
	mov    %rcx,0x18(%rdi)
	mov    -0x80(%rsp),%rbx
	mov    -0x78(%rsp),%rbp
	mov    -0x70(%rsp),%r12
	mov    -0x68(%rsp),%r13
	mov    -0x60(%rsp),%r14
	ret
